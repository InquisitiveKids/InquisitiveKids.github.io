//Block Editor by Ben F.
//Meant for use in "Block Adventure," found here:
//https://www.khanacademy.org/cs/block-adventure/2429986224

//Press "P" to print.
//If you wish for your creation to be visible in your spin-off, replace the "dat" variable with the text printed.

//Press "T" to see how your block tessellates.

//Mode 0:
//Select each pixel individually & edit it with the sliders.

//Mode 1:
//Choose color & use the mouse like a brush.

//Noise:
//Choose the noise level and add for blocky effect.

//Eraser:
//Toggle on/off with button. Use to make pixels transparent.








//Variables
var active=false;
var mouseOver=function(){active=true;};
var mouseOut=function(){active=false;};
var keys=[];
var keyPressed=function(){
    keys[keyCode]=true;
};
var keyReleased=function(){
    keys[keyCode]=false;
};
var keyTime=0;
var mTime=0;
var r=167;var g=168;var b=167;
var mode=1;
var on=0;
var mouseReleased=function(){
    on=0;
};
var nlvl=0;var eraser=0;

var dat=[0,0,0,0,[21,21,25],0,[29,32,33],[28,30,32],0,[28,31,32],0,0,0,0,0,0,0,0,0,[22,23,24],[104,56,9],[21,23,24],[111,63,15],[105,56,9],[28,31,33],[106,59,10],[24,28,29],[26,28,30],[26,27,30],0,0,0,0,0,[21,21,23],[107,58,11],[108,61,13],[102,54,5],[101,54,5],[102,53,6],[101,54,5],[102,55,6],[110,61,15],[109,60,12],[100,52,5],[20,22,24],0,0,0,0,[24,24,26],[107,60,12],[110,62,12],[101,51,4],[102,53,5],[102,54,6],[105,56,8],[109,60,12],[106,57,10],[101,54,6],[20,23,24],0,0,0,0,[23,25,27],[103,55,7],[100,53,5],[109,61,15],[103,55,7],[106,59,12],[104,58,9],[110,62,14],[100,53,5],[101,54,6],[111,61,13],[105,57,9],[30,33,35],0,0,0,[29,32,34],[104,54,7],[108,60,12],[101,53,4],[102,52,5],[104,55,7],[101,53,6],[107,59,11],[25,27,28],[108,59,12],[111,63,15],[101,54,6],[19,21,22],0,0,0,[21,23,24],[104,57,10],[99,51,5],[106,57,9],[20,22,24],[106,59,10],[23,24,27],[29,33,33],[207,159,90],[22,23,27],[22,24,26],[99,53,3],[26,28,31],0,0,0,0,[22,25,27],[107,60,12],[32,34,35],[213,163,94],[23,25,27],[251,250,251],[37,36,36],[213,162,94],[28,31,32],0,[24,26,26],0,0,0,0,0,[23,24,26],[99,53,3],[28,30,32],[208,158,88],[217,166,98],[243,243,243],[29,29,29],[218,167,100],[25,27,30],0,0,0,0,0,0,0,[21,25,25],[102,55,8],[23,26,28],[214,162,94],[208,157,88],[211,160,93],[213,162,93],[208,159,91],[209,157,88],[30,31,32],0,0,0,0,0,0,0,[24,25,26],0,[29,31,33],[210,159,90],[219,169,99],[210,161,91],[217,165,97],[20,23,24],0,0,0,0,0,0,0,0,0,0,0,[26,27,30],[20,22,25],[22,24,27],[20,23,25],0,0,0,0,0,0,0,0,0,0,0,[36,23,2],[24,27,28],[102,135,80],[99,135,81],[98,131,79],[26,28,32],0,0,0,0,0,0,0,0,[53,27,3],[36,23,2],[28,31,33],[23,27,28],[22,23,25],[92,125,72],[95,128,74],[23,23,26],[30,31,34],0,0,0,0,0,0,0,[53,27,3],[25,26,29],[25,28,30],[40,41,41],[27,28,30],[92,128,74],[101,135,81],[22,25,27],[21,24,27],0,0,0,0,0,0,0,[53,27,3],[22,23,24],[22,24,27],[41,41,42],[30,34,36],[92,125,70],[101,135,81],[30,32,33],[23,24,25],0,0,0,0,0,0,0,[53,27,3],[39,22,2],[24,27,29],[46,46,48],[23,26,27],[93,125,72],[91,124,70],[25,26,28],[24,27,27],0,0,0,0,0,0,0,[53,27,3],[19,22,23],[23,24,27],[42,44,43],[23,24,25],[101,135,81],[100,134,80],[31,32,34],[23,23,25],0,0,0,0,0,0,0,[53,27,3],[24,26,27],[22,24,25],[42,42,42],[19,20,23],[100,134,80],[96,132,78],[22,25,27],[21,23,24],0,0,0,0,0,0,0,0,[19,21,23],[23,24,27],[21,22,24],[28,31,31],[97,130,77],[95,131,76],[24,26,27],[28,29,31],0,0,0,0,0,0,0,0,[30,32,34],[208,158,88],[214,164,94],[32,34,34],[97,131,78],[92,125,72],[213,161,92],[207,158,89],0,0,0,0,0,0,0,0,0,[216,166,97],[21,22,22],[20,24,23],[25,27,26],[23,26,27],[208,159,89],0,0,0,0,0,0,0,0,0,0,[27,31,32],[55,57,58],[50,52,51],[37,40,40],[55,56,56],[24,28,28],0,0,0,0,0,0,0,0,0,0,[27,31,32],[54,55,55],[50,52,51],[37,40,40],[51,53,54],[24,25,27],0,0,0,0,0,0,0,0,0,0,[27,31,32],[48,48,49],[50,52,51],[37,40,40],[48,48,50],[23,27,27],0,0,0,0,0,0,0,0,0,0,[27,31,32],[50,52,51],[50,52,51],[37,40,40],[55,56,54],[27,31,32],0,0,0,0,0,0,0,0,0,0,[27,31,32],[47,49,49],[50,52,51],[37,40,40],[44,45,44],[29,31,34],0,0,0,0,0,0,0,0,0,0,[27,31,32],[44,45,46],[50,52,51],[37,40,40],[44,47,46],[20,23,25],0,0,0,0,0,0,0,0,0,0,[27,31,32],[44,45,45],[50,52,51],[37,40,40],[47,47,46],[20,23,24],0,0,0,0,0,0,0,0,0,0,[27,31,32],[48,49,49],[44,46,47],[37,40,40],[53,53,53],[31,34,35],0,0,0,0,0,0,0,0,0,0,[23,27,28],[23,25,27],[37,40,40],[22,23,25],[32,33,35],[25,28,30],0,0,0,0,0,0,0,0,0,0,[21,23,24],[32,32,35],[28,31,33],[28,30,31],[28,30,31],[25,27,29],[20,21,25],0,0,0,0];

//Draw Block
var bw=10;
var drawBlock=function(x,y){
    noStroke();
    var row=0;
    for(var i=0;i<512;i+=1){
        if(i!==0&&i%16===0){
            row+=1;
        }
        if(dat[i]){
        fill(dat[i][0],dat[i][1],dat[i][2]);
        rect(x+(i*bw)-(row*bw*16),y+(row*bw),bw,bw);
        }
    }
};

//Editor
var x=0;
var y=0;
var editor=function(){
    if(keyIsPressed&&keys[80]&&keyTime===0){
        var data="[";
        for(var i=0;i<512;i+=1){
            if(dat[i]){data+="[";}
            data+=dat[i];
            if(dat[i]){data+="]";}
            if(i!==511){data+=",";}
            else{data+="]";}
        }
        println(data);
    }
    //////////
    strokeWeight(1);
    stroke(0, 0, 0);
    noFill();
    if(mouseIsPressed&&mTime===0&&mouseX<160&&mouseY<320&&mode===0){
        x=round((mouseX-5)/10)*10;
        y=round((mouseY-5)/10)*10;
        r=dat[((y/10)*16)+(x/10)][0];
        g=dat[((y/10)*16)+(x/10)][1];
        b=dat[((y/10)*16)+(x/10)][2];
        if(!dat[((y/10)*16)+(x/10)]){dat[((y/10)*16)+(x/10)]=[];r=255;g=255;b=255;}
    }
    else if(mode===1&&mouseIsPressed&&mouseX<160&&mouseY<320){
        x=round((mouseX-5)/10)*10;
        y=round((mouseY-5)/10)*10;
    }
    if(mode===0){rect(x,y,10,10);}
    //////////
    var i=((y/10)*16)+(x/10);
    fill(r,g,b);
    rect(312,329,60,60);
    noStroke();
    fill(0, 0, 0);
    rect(30,333,255,5);
    rect(30,357,255,5);
    rect(30,381,255,5);
    fill(255, 0, 0);
    ellipse(r+30,335,20,20);
    fill(0, 255, 0);
    ellipse(g+30,359,20,20);
    fill(0, 0, 255);
    ellipse(b+30,383,20,20);
    if(mouseIsPressed){
    if(mouseX>r+10&&mouseX<r+50&&mouseY>325&&mouseY<345){
        on=1;
    }
    if(mouseX>g+10&&mouseX<g+50&&mouseY>347&&mouseY<367){
        on=2;
    }
    if(mouseX>b+10&&mouseX<b+50&&mouseY>371&&mouseY<391){
        on=3;
    }
    if(on===1&&mouseX>30&&mouseX<285){r=mouseX-30;}
    if(on===2&&mouseX>30&&mouseX<285){g=mouseX-30;}
    if(on===3&&mouseX>30&&mouseX<285){b=mouseX-30;}
    }
    ////////////
    if(mode===0){
        dat[i][0]=r;
        dat[i][1]=g;
        dat[i][2]=b;
        if(eraser){dat[i]=0;}
    }
    if(mode===1&&mouseIsPressed&&mouseX<320&&mouseY<320){
        if(!dat[i]){dat[i]=[];}
        dat[i][0]=r;
        dat[i][1]=g;
        dat[i][2]=b;
        if(eraser){dat[i]=0;}
    }
    ////////////
    fill(149, 204, 214);
    if(mouseX>330&&mouseX<390&&mouseY>9&&mouseY<69){
        fill(115, 158, 166);
        if(mouseIsPressed&&mTime===0){
            mode^=1;
            if(mode===0){
                if(dat[i]){
                    r=dat[i][0];
                    g=dat[i][1];
                    b=dat[i][2];
                }
                else{
                    r=255;g=255;b=255;
                }
            }
        }
    }
    rect(330,9,60,60);
    fill(149, 204, 214);
    if(mouseX>330&&mouseX<390&&mouseY>88&&mouseY<169){
        fill(115, 158, 166);
        if(mouseIsPressed&&mTime===0){
            nlvl+=1;
            if(nlvl===11){nlvl=0;}
        }
    }
    rect(330,88,60,81);
    fill(149, 204, 214);
    if(mouseX>330&&mouseX<390&&mouseY>190&&mouseY<243){
        fill(115, 158, 166);
        if(mouseIsPressed&&mTime===0){
            for(var i=0;i<512;i+=1){
                var ra=round(random(-nlvl,nlvl));
                dat[i][0]+=round(random(ra+1,ra-1));
                dat[i][1]+=round(random(ra+1,ra-1));
                dat[i][2]+=round(random(ra+1,ra-1));
            }
        }
    }
    rect(330,190,60,53);
    fill(149, 204, 214);
    if(mouseX>330&&mouseX<390&&mouseY>264&&mouseY<317){
        fill(115, 158, 166);
        if(mouseIsPressed&&mTime===0){
            eraser^=true;
        }
    }
    rect(330,264,60,53);
    fill(0, 0, 0);
    textSize(20);
    text("Mode:\n   "+mode,334,35);
    text("Noise\nLevel:\n   "+nlvl,334,113);
    text(" Add\nNoise",336,211);
    textSize(18);
    text("Eraser:\n    "+eraser,331,288);
};


draw= function() {
    background(207, 245, 255);
    noStroke();
    fill(237, 251, 255);
    rect(0,0,160,320);
    bw=10;
    drawBlock(0,0);
    editor();
    
    if(keyIsPressed){keyTime+=1;}
    else{keyTime=0;}
    if(mouseIsPressed){mTime+=1;}
    else{mTime=0;}
};